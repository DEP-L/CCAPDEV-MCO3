<div class="container-sm my-5 w-75">
    <h1>Dashboard</h1>
    <nav class="navbar navbar-expand-sm">
        <ul class="navbar-nav">
            <li class="nav-item">
                <a href="/profile/id/{{#if studentID}}{{studentID}}{{else}}{{techID}}{{/if}}?ownerID={{#if studentID}}{{studentID}}{{else}}{{techID}}{{/if}}" class="nav-link">
                    View Profile
                </a>
            </li>
            <li class="nav-item">
                <form action="/logout" method="POST">
                    <button type="submit" class="btn btn-link nav-link">Logout</button>
                </form>
            </li>
        </ul>
    </nav>

    <form action="/reserve-slot" method="POST">
        <div>
            <label class="form-label" for="lab">Select Lab</label>
            <select class="form-select" id="lab" name="lab">
            {{#each labs}}
                <option value="{{labID}}" {{#if (eq labID ../selectedLab.labID)}}selected{{/if}}>{{labName}}</option>
            {{/each}}
            </select>
        </div>

        <div>
            <label class="form-label" for="date">Select Date</label>
            <input class="form-control" type="date" id="date" name="date">
        </div>

        {{#if techID}}
        <div>
            <label class="form-label" for="studentID">Student ID</label>
            <input class="form-control" type="number" id="studentID" name="studentID" value="{{studentID}}">
        </div>
        {{/if}}

        <!-- table of lab slot availability -->
        {{#if selectedLab}}
            <h3>{{selectedLab.labName}}</h3>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Time Slot</th>
                        {{#times selectedLab.seatCount}}
                        <th>{{inc @index}}</th>
                        {{/times}}
                    </tr>
                </thead>
                <tbody>
                    {{#each selectedLab.timeList}}
                    <tr>
                        <td>{{this}}</td>
                        {{#times ../selectedLab.seatCount}}
                        <td>-----</td>
                        {{/times}}
                    </tr>
                    {{/each}}
                </tbody>
            </table>
        {{else}}
            <p>Please select a lab to view its schedule.</p>
        {{/if}}

        <div>
            <label class="form-label" for="timeSlots">Select Time Slots (Ctrl+Click to select multiple)</label>
            <select class="form-select" id="timeSlots" name="timeSlots" multiple size="5">
            {{#each selectedLab.timeList}}
                <option value="{{this}}">{{this}}</option>
            {{/each}}
            </select>
        </div>

        <div>
            <label class="form-label" for="seat">Select Seat</label>
            <select class="form-select" id="seat" name="seat">
            {{#times selectedLab.seatCount}}
                <option value="{{inc @index}}">{{inc @index}}</option>
            {{/times}}
            </select>
        </div>

        <button class="btn btn-outline-success" type="submit">Reserve Slots</button>
    </form>

    <!-- slots reserved for the lab, for the student if student, all if tech -->
    <form>

    </form>

    <script>
        document.getElementById('lab').addEventListener('change', function() {
            const selectedLabID = this.value;
            window.location.href = `/dashboard?labID=${selectedLabID}`;
        });
    </script>
</div>